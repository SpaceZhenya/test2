<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Ping Pong Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height:  100vh;
            background:  #000;
            overflow: hidden;
        }

        #canvas {
            display: block;
        }

        . overlay {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #00ff00;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            z-index: 100;
        }

        .score {
            position: fixed;
            top: 20px;
            font-size: 48px;
            font-weight:  bold;
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
        }

        #playerScore {
            left: 50px;
        }

        #computerScore {
            right: 50px;
        }

        . instructions {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #00ccff;
            font-size:  14px;
            text-align:  center;
            text-shadow: 0 0 10px #00ccff;
        }

        . status {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            color: #ffff00;
            font-size: 28px;
            font-weight:  bold;
            text-shadow:  0 0 10px #ffff00;
        }
    </style>
</head>
<body>
    <div class="score" id="playerScore">0</div>
    <div class="score" id="computerScore">0</div>
    <div class="status" id="status"></div>
    <div class="instructions">
        <p>Move MOUSE or use ARROW KEYS ↑↓ to control your paddle</p>
        <p>First to 5 points wins!</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, ball, paddleLeft, paddleRight, table;
        let gameState = {
            ballPos: { x: 0, y: 0, z: 0 },
            ballVel: { x: 0.5, y: 0, z:  0.3 },
            paddleLeftZ: 0,
            paddleRightZ: 0,
            playerScore: 0,
            computerScore: 0,
            gameActive: true,
            mouseY: 0,
            upPressed: false,
            downPressed: false
        };

        // Check if Three.js is loaded
        function initThreeJs() {
            if (typeof THREE === 'undefined') {
                setTimeout(initThreeJs, 100);
                return;
            }

            // Scene setup
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);

            // Camera
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                0.1,
                1000
            );
            camera.position.set(0, 10, 40);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            document.body.appendChild(renderer.domElement);

            // Lighting
            const light1 = new THREE.DirectionalLight(0xffffff, 1);
            light1.position. set(30, 30, 30);
            light1.castShadow = true;
            scene.add(light1);

            const light2 = new THREE.AmbientLight(0xffffff, 0.8);
            scene.add(light2);

            // Create Table
            const tableGeo = new THREE.BoxGeometry(80, 1, 40);
            const tableMat = new THREE.MeshLambertMaterial({ color: 0x004400 });
            table = new THREE.Mesh(tableGeo, tableMat);
            table.position.y = -1;
            table.castShadow = true;
            scene.add(table);

            // Create Walls
            const wallGeo = new THREE.BoxGeometry(80, 2, 1);
            const wallMat = new THREE.MeshLambertMaterial({ color: 0x00ff00 });

            const wall1 = new THREE.Mesh(wallGeo, wallMat);
            wall1.position. z = -20. 5;
            wall1.castShadow = true;
            scene.add(wall1);

            const wall2 = new THREE.Mesh(wallGeo, wallMat);
            wall2.position.z = 20.5;
            wall2.castShadow = true;
            scene.add(wall2);

            // Center Line
            const lineGeo = new THREE.BoxGeometry(1, 1, 40);
            const lineMat = new THREE.MeshLambertMaterial({ color: 0x00ff00 });
            const centerLine = new THREE.Mesh(lineGeo, lineMat);
            centerLine.castShadow = true;
            scene.add(centerLine);

            // Left Paddle (Player)
            const paddleGeo = new THREE.BoxGeometry(2, 1, 10);
            const paddleLeftMat = new THREE.MeshLambertMaterial({ color:  0xff0080 });
            paddleLeft = new THREE.Mesh(paddleGeo, paddleLeftMat);
            paddleLeft.position.x = -38;
            paddleLeft.castShadow = true;
            scene.add(paddleLeft);

            // Right Paddle (AI)
            const paddleRightMat = new THREE.MeshLambertMaterial({ color: 0x0080ff });
            paddleRight = new THREE.Mesh(paddleGeo, paddleRightMat);
            paddleRight. position.x = 38;
            paddleRight.castShadow = true;
            scene. add(paddleRight);

            // Ball
            const ballGeo = new THREE.SphereGeometry(0.8, 32, 32);
            const ballMat = new THREE.MeshLambertMaterial({ color:  0xffff00 });
            ball = new THREE. Mesh(ballGeo, ballMat);
            ball.castShadow = true;
            scene.add(ball);

            console.log("Game initialized successfully!");

            // Input listeners
            document.addEventListener('mousemove', (e) => {
                gameState.mouseY = (e.clientY / window.innerHeight) * 40 - 20;
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowUp') gameState.upPressed = true;
                if (e.key === 'ArrowDown') gameState.downPressed = true;
            });

            document.addEventListener('keyup', (e) => {
                if (e.key === 'ArrowUp') gameState.upPressed = false;
                if (e.key === 'ArrowDown') gameState.downPressed = false;
            });

            window.addEventListener('resize', () => {
                camera.aspect = window. innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            // Start game loop
            gameLoop();
        }

        function gameLoop() {
            requestAnimationFrame(gameLoop);

            if (gameState.gameActive) {
                // Update left paddle
                let targetZ = gameState.mouseY;
                if (gameState.upPressed) targetZ -= 2;
                if (gameState. downPressed) targetZ += 2;
                gameState.paddleLeftZ += (targetZ - gameState.paddleLeftZ) * 0.15;
                gameState.paddleLeftZ = Math.max(-15, Math.min(15, gameState.paddleLeftZ));
                paddleLeft.position.z = gameState.paddleLeftZ;

                // Update right paddle (AI)
                let targetAI = 0;
                if (gameState.ballVel.x > 0) {
                    targetAI = gameState.ballPos.z;
                    gameState.paddleRightZ += (targetAI - gameState.paddleRightZ) * 0.08;
                } else {
                    gameState.paddleRightZ += (0 - gameState.paddleRightZ) * 0.05;
                }
                gameState.paddleRightZ = Math.max(-15, Math.min(15, gameState.paddleRightZ));
                paddleRight.position.z = gameState.paddleRightZ;

                // Update ball
                gameState.ballPos.x += gameState.ballVel.x;
                gameState.ballPos.z += gameState.ballVel. z;

                // Collision with top/bottom walls
                if (gameState.ballPos.z <= -20 || gameState.ballPos.z >= 20) {
                    gameState.ballVel.z = -gameState.ballVel.z;
                    gameState.ballPos.z = gameState.ballPos.z <= -20 ? -20 :  20;
                }

                // Collision with left paddle
                if (gameState.ballVel.x < 0 &&
                    gameState.ballPos.x <= -37 &&
                    gameState. ballPos.z >= gameState.paddleLeftZ - 5 &&
                    gameState.ballPos.z <= gameState.paddleLeftZ + 5) {
                    gameState.ballVel.x = -gameState.ballVel.x;
                    gameState.ballPos.x = -37;
                    gameState.ballVel.z += (gameState.paddleLeftZ - gameState.ballPos.z) * 0.15;
                    gameState.ballVel.x *= 1.05;
                }

                // Collision with right paddle
                if (gameState.ballVel.x > 0 &&
                    gameState.ballPos.x >= 37 &&
                    gameState. ballPos.z >= gameState. paddleRightZ - 5 &&
                    gameState. ballPos.z <= gameState. paddleRightZ + 5) {
                    gameState. ballVel.x = -gameState.ballVel.x;
                    gameState.ballPos.x = 37;
                    gameState.ballVel. z += (gameState.paddleRightZ - gameState.ballPos.z) * 0.15;
                    gameState. ballVel.x *= 1.05;
                }

                // Scoring
                if (gameState.ballPos.x < -50) {
                    gameState. computerScore++;
                    resetBall();
                    if (gameState.computerScore >= 5) {
                        gameState.gameActive = false;
                        document.getElementById('status').textContent = 'AI WINS!  Press F5 to reload';
                    }
                }

                if (gameState.ballPos.x > 50) {
                    gameState.playerScore++;
                    resetBall();
                    if (gameState.playerScore >= 5) {
                        gameState.gameActive = false;
                        document.getElementById('status').textContent = 'YOU WIN!  Press F5 to reload';
                    }
                }

                // Speed damping
                if (Math.abs(gameState.ballVel.z) > 1) {
                    gameState.ballVel.z *= 0.98;
                }

                // Update positions
                ball.position.set(gameState.ballPos.x, gameState.ballPos.y, gameState.ballPos.z);

                // Update score display
                document.getElementById('playerScore').textContent = gameState. playerScore;
                document.getElementById('computerScore').textContent = gameState.computerScore;
            }

            renderer.render(scene, camera);
        }

        // Initialize when page loads
        window.addEventListener('load', initThreeJs);
    </script>
</body>
</html>
